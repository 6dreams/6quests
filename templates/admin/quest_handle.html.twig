{% extends 'base.html.twig' %}

{% block title %}{{ parent() }} - {{ quest.name }}{% endblock %}

{% block body %}
    <h2>{{ quest.name }} [<a href="{{ path('root_index') }}">Назад</a>]</h2>
    {% if quest.finished %}Квест завершён{% endif %}
    {% set titles = ['Команда', 'Прохождение', 'Штрафы', 'Итог'] %}
    <table class="editor-list" id="l">
        <tr>
            {% for i, title in titles %}
            <th onclick="admin.sort('l', {{ i }})">{{ title }}</th>
            {% endfor %}
            <th>Финиш</th>
        </tr>
        {% for info in list %}
        <tr>
            <td data-value="{{ info.team.id }}">№{{ info.team.id }} {{ info.team.name }}</td>
            <td data-value="{{ info.passing }}">{{ info.formatted(info.passing) }}</td>
            <td data-value="{{ info.penalty }}">{{ info.formatted(info.penalty) }}</td>
            <td data-value="{{ info.total }}">{{ info.formatted(info.total) }}</td>
            <td>{% if not info.team.finished %}<a class="button" href="{{ path('quest_finish', { 'id': info.team.id }) }}">Завершили</a>{% endif %}</td>
        </tr>
        {% endfor %}
    </table>

    {% if not quest.finished %}
        <a href="{{ path('quest_finish_force', { id: quest.id }) }}" class="red button" style="margin-top: 32pt">Завершить квест</a>
    {% endif %}
{% endblock %}

{% block javascripts %}
    {{ parent() }}
    <script src="/js/admin.js"></script>
{% endblock %}